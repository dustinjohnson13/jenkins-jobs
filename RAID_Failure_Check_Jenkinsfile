#!groovy

stage('Run') {
    node {

        def build = "${env.JOB_NAME} - #${env.BUILD_NUMBER}".toString()

        currentBuild.result = "SUCCESS"

        try {

            sh '{ cat /proc/mdstat | grep "(F)" && exit 1; } || exit 0'

        } catch (err) {
            currentBuild.result = "FAILURE"

            emailext body: "${env.JOB_NAME} failed! See ${env.BUILD_URL} for details.", recipientProviders: [[$class: 'DevelopersRecipientProvider']], subject: "$build failed!"

            throw err
        }
    }
}
